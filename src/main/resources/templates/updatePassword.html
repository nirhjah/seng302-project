<!--/*
    Update Password.

    Attributes:
    - updatePasswordForm: What our <form> data is bound to
*/-->

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://thymeleaf.org">

<head>
  <link th:href="@{/css/styles.css}" rel="stylesheet" />
  <link th:href="@{/css/edit-user.css}" rel="stylesheet" />
  <link th:href="@{/css/password.css}" rel="stylesheet" />
  <link rel="preload" as="image" th:href="@{/image/landscape.jpeg}">
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <meta http-equiv="Content-Type" context="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title th:inline="text">Edit User - Update Password</title>

<body class="edit-user-background">
  <div th:insert="~{fragments/navBar.html::navbar(displayTeams=${displayTeams})}"></div>


  <div class="user-form">
    <div class="user-header">
      <h1 th:inline="text">Update Password</h1>
    </div>
    <div class="wrapper">
      <form th:action="@{updatePassword}" method="post" th:object="${updatePasswordForm}" id="updatePasswordForm">
        <div class="edit-inputs">
          <div class="edit-user-header">
            <h2>Update Password</h2>
            <img th:src="@{/image/icons/lock.svg}" />
          </div>

          <!--/* Old Password Field */-->
          <div class="input-box">
            <input type="password" class="form-control" th:field="*{oldPassword}" data-cy="oldPassword" autofocus
              required>
            <label for="oldPassword">Old Password <span class="required">*</span></label>
            <img th:src="@{/image/icons/hide.png}" class="password-toggle" data-pw-field="oldPassword"/>
          </div>
          <div th:each="err : ${#fields.errors('oldPassword')}" th:text="${err}" class="error-message"></div>
          <!--/* New Password Field */-->
          <div class="input-box">
            <input type="password" class="form-control" th:field="*{newPassword}" data-cy="newPassword" required>
            <label for="newPassword">New Password <span class="required">*</span></label>
            <img th:src="@{/image/icons/hide.png}" class="password-toggle" data-pw-field="newPassword"/>
          </div>
          <div th:each="err : ${#fields.errors('newPassword')}" th:text="${err}" class="error-message"></div>
          <!--/* Confirm Password Field */-->
          <div class="input-box">
            <input type="password" class="form-control" th:field="*{confirmPassword}" data-cy="confirmPassword" required>
            <label for="confirmPassword">Retype Password <span class="required">*</span></label>
            <img th:src="@{/image/icons/hide.png}" class="password-toggle" data-pw-field="confirmPassword"/>
          </div>
            <div th:each="err : ${#fields.errors('confirmPassword')}" th:text="${err}" class="error-message"></div>
          </div>
          <br><br>
          <ul class="password-info password-information-text">
            <li>Password must be at least 8 characters</li>
            <li>Must contain the following items</li>
            <ul>
                <li>Uppercase and lowercase letters</li>
                <li>Numbers</li>
                <li>Symbols</li>
            </ul>
            <li>Mustn't contain your name or email</li>
          </ul>

          <!--/* Submit Button */-->
          <div class="submit-button">
              <label th:if="${errorMessage}" th:text="${errorMessage}" style="position: fixed;"></label>
              <a th:href="@{home}">
                  <button type="submit" id="submit" formnovalidate>Save</button>
              </a>
          </div>
          <div class="cancel-link">
              <a th:href="@{user-info/self}">Cancel</a>
          </div>
            </form>
        </div>
    <footer>
        <p>
            Image by <a
                href="https://www.freepik.com/free-vector/flat-happy-children-play-run-cycling-public-park_27059506.htm#query=nature%20sports%20illustration&position=0&from_view=search&track=ais">redgreystock</a>
            on Freepik
        </p>
    </footer>
  </div>
  <!--/* Reveal Password code */-->
  <script>
    const passwordToggle = document.getElementsByClassName('password-toggle');
    for (const button of passwordToggle) {
      const passwordFieldId = button.dataset.pwField;
      const passwordInput = document.getElementById(passwordFieldId);
      button.addEventListener('mousedown', function () {
        passwordInput.type = 'text';
        button.src = '/image/icons/view.png';
      });

      button.addEventListener('mouseup', function () {
        passwordInput.type = 'password';
        button.src = '/image/icons/hide.png';
      });

      button.addEventListener('mouseout', function () {
        passwordInput.type = 'password';
        button.src = '/image/icons/hide.png';
      });
    }
  </script>
</body>
</html>